!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,t.Neo4jd3=e()}}(function(){return function(){function e(t,n,r){function o(a,s){if(!n[a]){if(!t[a]){var l="function"==typeof require&&require;if(!s&&l)return l(a,!0);if(i)return i(a,!0);var u=new Error("Cannot find module '"+a+"'");throw u.code="MODULE_NOT_FOUND",u}var c=n[a]={exports:{}};t[a][0].call(c.exports,function(e){return o(t[a][1][e]||e)},c,c.exports,e,t,n,r)}return n[a].exports}for(var i="function"==typeof require&&require,a=0;a<r.length;a++)o(r[a]);return o}return e}()({1:[function(e,t,n){"use strict";var r=e("./scripts/neo4jd3");t.exports=r},{"./scripts/neo4jd3":2}],2:[function(e,t,n){"use strict";function r(e,t){function n(e){ze=e.append("svg").attr("width","100%").attr("height","100%").attr("class","neo4jd3-graph").call(d3.zoom().on("zoom",function(){var e=d3.event.transform.k,t=[d3.event.transform.x,d3.event.transform.y];Ve&&(t[0]+=Ve[0],t[1]+=Ve[1]),He&&(e*=He),ze.attr("transform","translate("+t[0]+", "+t[1]+") scale("+e+")")})).on("dblclick.zoom",null).append("g").attr("width","100%").attr("height","100%"),Fe=ze.append("g").attr("class","relationships"),Se=ze.append("g").attr("class","nodes")}function r(e){return e.append("div").attr("class","neo4jd3-info")}function o(e,t,n,r){var o=we.append("a");o.attr("href","#").attr("class",e).html("<strong>"+n+"</strong>"+(r?": "+r:"")),r||o.style("background-color",function(e){return Te.nodeOutlineFillColor?Te.nodeOutlineFillColor:t?k(n):D()}).style("border-color",function(e){return Te.nodeOutlineFillColor?C(Te.nodeOutlineFillColor):t?C(n):O()}).style("color",function(e){return Te.nodeOutlineFillColor?C(Te.nodeOutlineFillColor):"#fff"})}function i(e,t){o(e,!0,t)}function a(e,t,n){o(e,!1,t,n)}function s(e,t){o(e,!1,t)}function l(e,t){d3.selectAll(".context-menu").data([1]).enter().append("div").attr("class","context-menu"),d3.select("body").on("click.context-menu",function(){d3.select(".context-menu").style("display","none")}),d3.selectAll(".context-menu").html("").append("ul").selectAll("li").data(Te.contextMenu).enter().append("li").on("contextmenu",function(e){d3.event.preventDefault()}).on("click",function(t){t.handler(e),d3.select(".context-menu").style("display","none")}).append("i").attr("class",function(e){return e.icon}).text(function(e){return" "+e.text}),d3.select(".context-menu").style("left",d3.event.pageX-2+"px").style("top",d3.event.pageY-2+"px").style("display","block"),d3.event.preventDefault()}function u(){return ke.enter().append("g").on("contextmenu",l).attr("id",function(e){return e.uuid=de(),e.uuid}).attr("class",function(e){var t="node";e.labels[0];return z(e)&&(t+=" node-image"),t}).on("click",function(e){"function"==typeof Te.onNodeClick&&Te.onNodeClick(e)}).on("dblclick",function(e){"function"==typeof Te.onNodeDoubleClick&&Te.onNodeDoubleClick(e)}).on("mouseenter",function(e){we&&re(e),"function"==typeof Te.onNodeMouseEnter&&Te.onNodeMouseEnter(e)}).on("mouseleave",function(e){"function"==typeof Te.onNodeMouseLeave&&Te.onNodeMouseLeave(e)}).call(d3.drag().on("start",R).on("drag",E).on("end",j))}function c(){var e=u();return y(e),p(e),h(e),f(e),d(e),e}function d(e){return e.append("text").attr("class","text icon").attr("fill","#ffffff").attr("font-size","25px").attr("pointer-events","none").attr("text-anchor","middle").attr("y",parseInt(Math.round(.32*Te.nodeRadius))+"px").html(function(e){var t=Te.iconMap[e.labels[0].toLowerCase()];return t?"&#x"+t:""})}function f(e){return e.append("image").attr("height","24px").attr("x","5px").attr("y","5px").attr("width","24px")}function p(e){return e.append("circle").attr("class","outline").attr("r",Te.nodeRadius).style("fill",function(e){return Te.nodeOutlineFillColor?Te.nodeOutlineFillColor:k(e.labels[0])}).style("stroke",function(e){return C(Te.nodeOutlineFillColor?Te.nodeOutlineFillColor:e.labels[0])}).append("title").text(function(e){return Q(e)})}function y(e){return e.append("circle").attr("class","ring").attr("r",1.16*Te.nodeRadius).append("title").text(function(e){return Q(e)})}function x(e,t){return null==t&&(t=100),e.length>t?e.substring(0,t-"...".length)+"...":e}function h(e){var t=e.append("g");t.append("rect").attr("width","80px").attr("height","20px").style("fill","#bdc3c7").attr("y",28).attr("x",-40).attr("rx",10).attr("ry",10),t.append("text").text(function(e){return e.properties.name?x(e.properties.name,15):e.id}).attr("font-size",10).attr("x",0).attr("y",37).attr("text-anchor","middle").attr("alignment-baseline","central")}function g(){return Ne.enter().append("g").attr("id",function(e){return e.uuid=de(),e.uuid}).attr("class","relationship").on("dblclick",function(e){"function"==typeof Te.onRelationshipDoubleClick&&Te.onRelationshipDoubleClick(e)}).on("mouseenter",function(e){we&&re(e)})}function v(e){return e.append("path").attr("class","outline").attr("fill","#a5abb6").attr("stroke","none")}function m(e){return e.append("path").attr("class","overlay")}function b(e){return e.append("text").attr("class","text").attr("fill","#000000").attr("font-size","8px").attr("pointer-events","none").attr("text-anchor","middle").text(function(e){return e.type})}function w(){var e=g(),t=b(e);return{outline:v(e),overlay:m(e),relationship:e,text:t}}function k(e){var t=Ae[e];return t||(t=Te.colors[qe%Te.colors.length],Ae[e]=t,qe++),t}function C(e){return d3.rgb(k(e)).darker(1)}function N(){we.html("")}function M(){return["#68bdf6","#6dce9e","#faafc2","#f2baf6","#ff928c","#fcea7e","#ffc766","#405f9e","#a5abb6","#78cecb","#b88cbb","#ced2d9","#e84646","#fa5f86","#ffab1a","#fcda19","#797b80","#c9d96f","#47991f","#70edee","#ff75ea"]}function L(e,t){return e.filter(function(e){return e.id===t}).length>0}function D(){return Te.relationshipColor}function O(){return d3.rgb(Te.colors[Te.colors.length-1]).darker(1)}function j(e){d3.event.active||Re.alphaTarget(0),"function"==typeof Te.onNodeDragEnd&&Te.onNodeDragEnd(e)}function E(e){G(e)}function R(e){d3.event.active||Re.alphaTarget(.3).restart(),e.fx=e.x,e.fy=e.y,"function"==typeof Te.onNodeDragStart&&Te.onNodeDragStart(e)}function z(e){var t,n,r,o,i,a,s,l;if(Te.images&&(n=Te.imageMap[e.labels[0]]))for(o=0,t=0;t<n.length;t++){switch(a=n[t].split("|"),a.length){case 3:l=a[2];case 2:s=a[1];case 1:i=a[0]}e.labels[0]!==i||s&&void 0===e.properties[s]||l&&e.properties[s]!==l||a.length>o&&(r=Te.images[n[t]],o=a.length)}return r}function S(e,t){A(Te,t),Te.icons&&(Te.showIcons=!0),Te.minCollision||(Te.minCollision=2*Te.nodeRadius),Ee=e,be=d3.select(Ee),be.attr("class","neo4jd3").html(""),Te.infoPanel&&(we=r(be)),n(be),Re=F(),Te.neo4jData?H(Te.neo4jData):Te.neo4jDataUrl?V(Te.neo4jDataUrl):console.error("Error: both neo4jData and neo4jDataUrl are empty!"),je=Oe.map(function(e){return Object.assign({},e)})}function F(){return d3.forceSimulation().force("collide",d3.forceCollide().radius(function(e){return Te.minCollision})).force("charge",d3.forceManyBody()).force("link",d3.forceLink().id(function(e){return e.id})).force("center",d3.forceCenter(ze.node().parentElement.parentElement.clientWidth/2,ze.node().parentElement.parentElement.clientHeight/2)).on("tick",function(){Z()}).on("end",function(){Te.zoomFit&&!Ue&&(Ue=!0,le(2))})}function H(){Ce=[],Oe=[],ne(Te.neo4jData)}function V(e){Ce=[],Oe=[],d3.json(e,function(e,t){if(e)throw e;ne(t)})}function A(e,t){Object.keys(t).forEach(function(n){e[n]=t[n]})}function U(e){var t={nodes:[],relationships:[]};return e.results.forEach(function(e){e.data.forEach(function(e){e.graph.nodes.forEach(function(e){L(t.nodes,e.id)||t.nodes.push(e)}),e.graph.relationships.forEach(function(e){L(t.relationships,e.id)||(e.source=e.startNode,e.target=e.endNode,t.relationships.push(e))}),e.graph.relationships.sort(function(e,t){return e.source>t.source?1:e.source<t.source?-1:e.target>t.target?1:e.target<t.target?-1:0});for(var n=0;n<e.graph.relationships.length;n++)0!==n&&e.graph.relationships[n].source===e.graph.relationships[n-1].source&&e.graph.relationships[n].target===e.graph.relationships[n-1].target?e.graph.relationships[n].linknum=e.graph.relationships[n-1].linknum+1:e.graph.relationships[n].linknum=1})}),t}function q(e,t,n){for(var r,o,i={nodes:[],relationships:[]},a=0;a<t.length;a++)r={id:t[a].id,labels:t[a].labels,properties:t[a].properties,x:e.x,y:e.y},i.nodes[i.nodes.length]=r;for(var s=0;s<n.length;s++)o={id:n[s].id,type:n[s].type,startNode:e.id.toString(),endNode:n[s].endNode,properties:n[s].properties,source:e.id,target:n[s].endNode},i.relationships[i.relationships.length]=o;te(i)}function T(e,t,n){for(var r,o,i={nodes:[],relationships:[]},a=0;a<t.length;a++)r={id:t[a].id,labels:t[a].labels,properties:t[a].properties,x:e.x,y:e.y},i.nodes[i.nodes.length]=r;for(var s=0;s<n.length;s++)o={id:n[s].id,type:n[s].type,startNode:n[s].startNode,endNode:e.id.toString(),properties:n[s].properties,source:n[s].startNode,target:e.id},i.relationships[i.relationships.length]=o;te(i)}function B(e,t,n,r,o){var i=Math.PI/180*o,a=Math.cos(i),s=Math.sin(i);return{x:a*(n-e)+s*(r-t)+e,y:a*(r-t)-s*(n-e)+t}}function I(e,t,n){return B(e.x,e.y,t.x,t.y,n)}function W(e,t){return 180*Math.atan2(t.y-e.y,t.x-e.x)/Math.PI}function P(){return{nodes:Ce.length,relationships:Oe.length}}function G(e){e.fx=d3.event.x,e.fy=d3.event.y}function Z(){J(),_()}function J(){ke&&ke.attr("transform",function(e){return"translate("+e.x+", "+e.y+")"})}function _(){Ne&&(Ne.attr("transform",function(e){var t=W(e.source,e.target);return"translate("+e.source.x+", "+e.source.y+") rotate("+t+")"}),K(),X(),Y())}function X(){Ne.each(function(){var e=d3.select(this),t=e.select(".outline"),n=e.select(".text");t.attr("d",function(e){var t={x:0,y:0},r=W(e.source,e.target),o=n.node().getBBox(),i=ee(e.source,e.target),a={x:.5*(e.target.x-e.source.x-(o.width+5)*i.x),y:.5*(e.target.y-e.source.y-(o.width+5)*i.y)},s=$(e.source,e.target),l=I(t,{x:0+(Te.nodeRadius+1)*i.x-s.x,y:0+(Te.nodeRadius+1)*i.y-s.y},r),u=I(t,{x:a.x-s.x,y:a.y-s.y},r),c=I(t,{x:a.x,y:a.y},r),d=I(t,{x:0+(Te.nodeRadius+1)*i.x,y:0+(Te.nodeRadius+1)*i.y},r),f=I(t,{x:e.target.x-e.source.x-a.x-s.x,y:e.target.y-e.source.y-a.y-s.y},r),p=I(t,{x:e.target.x-e.source.x-(Te.nodeRadius+1)*i.x-s.x-i.x*Te.arrowSize,y:e.target.y-e.source.y-(Te.nodeRadius+1)*i.y-s.y-i.y*Te.arrowSize},r),y=I(t,{x:e.target.x-e.source.x-(Te.nodeRadius+1)*i.x-s.x+(s.x-i.x)*Te.arrowSize,y:e.target.y-e.source.y-(Te.nodeRadius+1)*i.y-s.y+(s.y-i.y)*Te.arrowSize},r),x=I(t,{x:e.target.x-e.source.x-(Te.nodeRadius+1)*i.x,y:e.target.y-e.source.y-(Te.nodeRadius+1)*i.y},r),h=I(t,{x:e.target.x-e.source.x-(Te.nodeRadius+1)*i.x+(-s.x-i.x)*Te.arrowSize,y:e.target.y-e.source.y-(Te.nodeRadius+1)*i.y+(-s.y-i.y)*Te.arrowSize},r),g=I(t,{x:e.target.x-e.source.x-(Te.nodeRadius+1)*i.x-i.x*Te.arrowSize,y:e.target.y-e.source.y-(Te.nodeRadius+1)*i.y-i.y*Te.arrowSize},r),v=I(t,{x:e.target.x-e.source.x-a.x,y:e.target.y-e.source.y-a.y},r);return"M "+l.x+" "+l.y+" L "+u.x+" "+u.y+" L "+c.x+" "+c.y+" L "+d.x+" "+d.y+" Z M "+f.x+" "+f.y+" L "+p.x+" "+p.y+" L "+y.x+" "+y.y+" L "+x.x+" "+x.y+" L "+h.x+" "+h.y+" L "+g.x+" "+g.y+" L "+v.x+" "+v.y+" Z"})})}function Y(){Le.attr("d",function(e){var t={x:0,y:0},n=W(e.source,e.target),r=$(e.source,e.target),o=$(e.source,e.target,50),i=I(t,{x:0-o.x,y:0-o.y},n),a=I(t,{x:e.target.x-e.source.x-o.x,y:e.target.y-e.source.y-o.y},n),s=I(t,{x:e.target.x-e.source.x+o.x-r.x,y:e.target.y-e.source.y+o.y-r.y},n),l=I(t,{x:0+o.x-r.x,y:0+o.y-r.y},n);return"M "+i.x+" "+i.y+" L "+a.x+" "+a.y+" L "+s.x+" "+s.y+" L "+l.x+" "+l.y+" Z"})}function K(){De.attr("transform",function(e){var t=(W(e.source,e.target)+360)%360,n=t>90&&t<270,r={x:0,y:0},o=$(e.source,e.target),i=n?2:-3,a={x:.5*(e.target.x-e.source.x)+o.x*i,y:.5*(e.target.y-e.source.y)+o.y*i},s=I(r,a,t);return"translate("+s.x+", "+s.y+") rotate("+(n?180:0)+")"})}function Q(e){var t=e.labels?e.labels[0]:e.type;return t+=" (<id>: "+e.id,Object.keys(e.properties).forEach(function(n){t+=", "+n+": "+JSON.stringify(e.properties[n])}),t+=")"}function $(e,t,n){return I({x:0,y:0},ee(e,t,n),90)}function ee(e,t,n){var r=Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))/Math.sqrt(n||1);return{x:(t.x-e.x)/r,y:(t.y-e.y)/r}}function te(e){ie(e.nodes,e.relationships,!0)}function ne(e){te(U(e))}function re(e){N(),e.labels?i("class",e.labels[0]):s("class",e.type),a("property","&lt;id&gt;",e.id),Object.keys(e.properties).forEach(function(t){a("property",t,JSON.stringify(e.properties[t]))})}function oe(e,t){t&&Array.prototype.push.apply(Ce,e),ke=Se.selectAll(".node").data(Ce,function(e){return e.id});var n=c();ke=n.merge(ke)}function ie(e,t,n){ae(t,n),oe(e,n),Re.nodes(Ce),Re.force("link").links(Oe)}function ae(e,t){t&&Array.prototype.push.apply(Oe,e),Ne=Fe.selectAll(".relationship").data(Oe,function(e){return e.id});var n=w();Ne=n.relationship.merge(Ne),Me=ze.selectAll(".relationship .outline"),Me=n.outline.merge(Me),Le=ze.selectAll(".relationship .overlay"),Le=n.overlay.merge(Le),De=ze.selectAll(".relationship .text"),De=n.text.merge(De)}function se(){return Be}function le(e){var t=ze.node().getBBox(),n=ze.node().parentElement.parentElement,r=n.clientWidth,o=n.clientHeight,i=t.width,a=t.height,s=t.x+i/2,l=t.y+a/2;0!==i&&0!==a&&(He=.85/Math.max(i/r,a/o),Ve=[r/2-He*s,o/2-He*l],ze.attr("transform","translate("+Ve[0]+", "+Ve[1]+") scale("+He+")"))}function ue(n){var r=Object.assign(t,{neo4jData:n,neo4jDataUrl:void 0});S(e,r)}function ce(e){Oe=Oe.filter(function(t){return t.source!==e&&t.target!==e||(d3.select("#"+t.uuid).remove(),!1)}),Ce=Ce.filter(function(t){return t!==e}),d3.select("#"+e.uuid).remove(),ie(Ce,Oe,!1)}function de(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return"g"+e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()}function fe(e){d3.selectAll(".views").remove();var t=d3.select("svg").selectAll("rect.views").data(e),n=20;return t.enter().append("rect").classed("views",!0).attr("x",n).attr("y",function(t){return 2.2*(e.indexOf(t)+1)*n+27}).attr("rx",n/3).attr("rx",n/3).attr("width",80).attr("height",n).attr("fill",function(t){return M()[e.indexOf(t)+1]}).attr("stroke",function(e){return"#000000"}).attr("stroke-width",function(e){return"0.5px"}).attr("cursor","pointer").on("click",function(e){"function"==typeof Te.onViewsClickHandler&&Te.onViewsClickHandler(e)}).on("mouseover",function(e){"function"==typeof Te.onViewsMouseOverHandler&&Te.onViewsMouseOverHandler(e)}).on("mouseleave",function(e){"function"==typeof Te.onViewsMouseLeaveHandler&&Te.onViewsMouseLeaveHandler(e)}),d3.select("svg").selectAll("text.views").data(e).enter().append("text").classed("views",!0).attr("text-anchor","left").attr("font-weight","bold").attr("stroke-width","0").attr("stroke-color","white").attr("fill","#696969").attr("x",40).attr("font-size","10px").attr("cursor","pointer").text(function(e){return e}).attr("y",function(t){return 2.2*(e.indexOf(t)+1)*n+40}).on("click",function(e){"function"==typeof Te.onViewsClickHandler&&Te.onViewsClickHandler(e)}).on("mouseover",function(e){"function"==typeof Te.onViewsMouseOverHandler&&Te.onViewsMouseOverHandler(e)}).on("mouseleave",function(e){"function"==typeof Te.onViewsMouseLeaveHandler&&Te.onViewsMouseLeaveHandler(e)}),t.exit().remove()}function pe(e){e.forEach(function(e){d3.select("#"+e.uuid).classed("node-highlighted",!0)})}function ye(e){e.forEach(function(e){d3.select("#"+e.uuid).classed("node-highlighted",!1)})}function xe(e){Ce.sort(function(t,n){return e[t.labels[0].toLowerCase()]-e[n.labels[0].toLowerCase()]});var t=0,n=700,r=200;Ce.forEach(function(o){e[o.labels[0].toLowerCase()]!==t&&(t=e[o.labels[0].toLowerCase()],r+=130,n=700),n+=150,o.fx=n,o.fy=r})}function he(e){Ce.sort(function(t,n){return e[t.labels[0].toLowerCase()]-e[n.labels[0].toLowerCase()]});var t=0,n=700,r=200;Ce.forEach(function(o){e[o.labels[0].toLowerCase()]!==t&&(t=e[o.labels[0].toLowerCase()],r=200,n+=150),r+=150,o.fx=n,o.fy=r})}function ge(){return{nodes:Ce,relationships:Oe}}function ve(e){var t={nodes:[],relationships:[]},n=P();e.previous.forEach(function(r,o){var i=+Math.floor(200*Math.random()-75),a={id:r.node.id,labels:r.node.labels,properties:r.node.properties,x:e.x+i,y:e.y+i,fx:e.fx+i,fy:e.fy+i};t.nodes[t.nodes.length]=a,t.relationships[t.relationships.length]={id:r.link.id,type:r.link.type,properties:r.link.properties,startNode:a.id,endNode:e.id,source:a.id,target:e.id,linknum:n.relationships+1+o};var s=je.filter(function(e){return e.source.id===a.id||e.target.id===a.id}),l=Oe.filter(function(t){return t.source===e||t.target===e});s.forEach(function(e){var t=l.find(function(t){return t.id===e.id});t&&(e.source.id===a.id?t.source=a:t.target=a)})}),e.collapsed=!1,e.previous=[],te(t)}function me(e,t){if(t[e.labels[0].toLowerCase()]){var n=Oe.filter(function(t){return t.source===e||t.target===e}),r=n.find(function(n){return t.link.includes(n.type.toLowerCase())&&n.target.labels[0].toLowerCase()===t[e.labels[0].toLowerCase()]});r&&(r.target.collapsed=!0,n.splice(n.indexOf(r),1),r.target.previous||(r.target.previous=[]),r.target.previous.push({node:e,link:r}),n.forEach(function(t){t.collapsed=!0,t.source===e?(t.source=r.target,t.startNode=r.target.id):(t.target=r.target,t.endNode=r.target.id)}),ce(e))}}var be,we,ke,Ce,Ne,Me,Le,De,Oe,je,Ee,Re,ze,Se,Fe,He,Ve,Ae={},Ue=!1,qe=0,Te={arrowSize:4,colors:M(),highlight:void 0,iconMap:{},icons:void 0,imageMap:{},images:void 0,infoPanel:!0,minCollision:void 0,neo4jData:void 0,neo4jDataUrl:void 0,nodeOutlineFillColor:void 0,nodeRadius:25,relationshipColor:"#a5abb6",zoomFit:!1},Be="0.0.1";return S(e,t),{neo4jDataToD3Data:U,size:P,updateWithD3Data:te,updateWithNeo4jData:ne,appendDataToNodeOutward:q,appendDataToNodeInward:T,resetWithNeo4jData:ue,removeNode:ce,createViews:fe,highlightNodes:pe,unHighlightNodes:ye,orientForceGraphVertical:xe,orientForceGraphHorizontal:he,getGraph:ge,collapseNode:me,expandNode:ve,version:se}}t.exports=r},{}]},{},[1])(1)});