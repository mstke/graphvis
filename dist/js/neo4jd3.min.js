!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var e;e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,e.Neo4jd3=t()}}(function(){return function(){function t(e,n,r){function o(a,s){if(!n[a]){if(!e[a]){var u="function"==typeof require&&require;if(!s&&u)return u(a,!0);if(i)return i(a,!0);var l=new Error("Cannot find module '"+a+"'");throw l.code="MODULE_NOT_FOUND",l}var c=n[a]={exports:{}};e[a][0].call(c.exports,function(t){return o(e[a][1][t]||t)},c,c.exports,t,e,n,r)}return n[a].exports}for(var i="function"==typeof require&&require,a=0;a<r.length;a++)o(r[a]);return o}return t}()({1:[function(t,e,n){"use strict";var r=t("./scripts/neo4jd3");e.exports=r},{"./scripts/neo4jd3":2}],2:[function(t,e,n){"use strict";function r(t,e){function n(t){zt=t.append("svg").attr("width","100%").attr("height","100%").attr("class","neo4jd3-graph").call(d3.zoom().on("zoom",function(){var t=d3.event.transform.k,e=[d3.event.transform.x,d3.event.transform.y];Vt&&(e[0]+=Vt[0],e[1]+=Vt[1]),Ht&&(t*=Ht),zt.attr("transform","translate("+e[0]+", "+e[1]+") scale("+t+")")})).on("dblclick.zoom",null).append("g").attr("width","100%").attr("height","100%"),Ft=zt.append("g").attr("class","relationships"),St=zt.append("g").attr("class","nodes")}function r(t){return t.append("div").attr("class","neo4jd3-info")}function o(t,e,n,r){var o=wt.append("a");o.attr("href","#").attr("class",t).html("<strong>"+n+"</strong>"+(r?": "+r:"")),r||o.style("background-color",function(t){return Tt.nodeOutlineFillColor?Tt.nodeOutlineFillColor:e?k(n):D()}).style("border-color",function(t){return Tt.nodeOutlineFillColor?C(Tt.nodeOutlineFillColor):e?C(n):O()}).style("color",function(t){return Tt.nodeOutlineFillColor?C(Tt.nodeOutlineFillColor):"#fff"})}function i(t,e){o(t,!0,e)}function a(t,e,n){o(t,!1,e,n)}function s(t,e){o(t,!1,e)}function u(t,e){d3.selectAll(".context-menu").data([1]).enter().append("div").attr("class","context-menu"),d3.select("body").on("click.context-menu",function(){d3.select(".context-menu").style("display","none")}),d3.selectAll(".context-menu").html("").append("ul").selectAll("li").data(Tt.contextMenu).enter().append("li").on("contextmenu",function(t){d3.event.preventDefault()}).on("click",function(e){e.handler(t),d3.select(".context-menu").style("display","none")}).append("i").attr("class",function(t){return t.icon}).text(function(t){return" "+t.text}),d3.select(".context-menu").style("left",d3.event.pageX-2+"px").style("top",d3.event.pageY-2+"px").style("display","block"),d3.event.preventDefault()}function l(){return kt.enter().append("g").on("contextmenu",u).attr("id",function(t){return t.uuid=dt(),t.uuid}).attr("class",function(t){var e="node";t.labels[0];return z(t)&&(e+=" node-image"),e}).on("click",function(t){"function"==typeof Tt.onNodeClick&&Tt.onNodeClick(t)}).on("dblclick",function(t){"function"==typeof Tt.onNodeDoubleClick&&Tt.onNodeDoubleClick(t)}).on("mouseenter",function(t){wt&&rt(t),"function"==typeof Tt.onNodeMouseEnter&&Tt.onNodeMouseEnter(t)}).on("mouseleave",function(t){"function"==typeof Tt.onNodeMouseLeave&&Tt.onNodeMouseLeave(t)}).call(d3.drag().on("start",R).on("drag",E).on("end",j))}function c(){var t=l();return y(t),p(t),h(t),f(t),d(t),t}function d(t){return t.append("text").attr("class","text icon").attr("fill","#ffffff").attr("font-size","25px").attr("pointer-events","none").attr("text-anchor","middle").attr("y",parseInt(Math.round(.32*Tt.nodeRadius))+"px").html(function(t){var e=Tt.iconMap[t.labels[0].toLowerCase()];return e?"&#x"+e:""})}function f(t){return t.append("image").attr("height","24px").attr("x","5px").attr("y","5px").attr("width","24px")}function p(t){return t.append("circle").attr("class","outline").attr("r",Tt.nodeRadius).style("fill",function(t){return Tt.nodeOutlineFillColor?Tt.nodeOutlineFillColor:k(t.labels[0])}).style("stroke",function(t){return C(Tt.nodeOutlineFillColor?Tt.nodeOutlineFillColor:t.labels[0])}).append("title").text(function(t){return Q(t)})}function y(t){return t.append("circle").attr("class","ring").attr("r",1.16*Tt.nodeRadius).append("title").text(function(t){return Q(t)})}function x(t,e){return null==e&&(e=100),t.length>e?t.substring(0,e-"...".length)+"...":t}function h(t){var e=t.append("g");e.append("rect").attr("width","80px").attr("height","20px").style("fill","#bdc3c7").attr("y",28).attr("x",-40).attr("rx",10).attr("ry",10),e.append("text").text(function(t){return t.properties.name?x(t.properties.name,15):t.id}).attr("font-size",10).attr("x",0).attr("y",37).attr("text-anchor","middle").attr("alignment-baseline","central")}function g(){return Mt.enter().append("g").attr("id",function(t){return t.uuid=dt(),t.uuid}).attr("class","relationship").on("dblclick",function(t){"function"==typeof Tt.onRelationshipDoubleClick&&Tt.onRelationshipDoubleClick(t)}).on("mouseenter",function(t){wt&&rt(t)})}function v(t){return t.append("path").attr("class","outline").attr("fill","#a5abb6").attr("stroke","none")}function m(t){return t.append("path").attr("class","overlay")}function b(t){return t.append("text").attr("class","text").attr("fill","#000000").attr("font-size","8px").attr("pointer-events","none").attr("text-anchor","middle").text(function(t){return t.type})}function w(){var t=g(),e=b(t);return{outline:v(t),overlay:m(t),relationship:t,text:e}}function k(t){var e=At[t];return e||(e=Tt.colors[Ut%Tt.colors.length],At[t]=e,Ut++),e}function C(t){return d3.rgb(k(t)).darker(1)}function M(){wt.html("")}function N(){return["#68bdf6","#6dce9e","#faafc2","#f2baf6","#ff928c","#fcea7e","#ffc766","#405f9e","#a5abb6","#78cecb","#b88cbb","#ced2d9","#e84646","#fa5f86","#ffab1a","#fcda19","#797b80","#c9d96f","#47991f","#70edee","#ff75ea"]}function L(t,e){return t.filter(function(t){return t.id===e}).length>0}function D(){return Tt.relationshipColor}function O(){return d3.rgb(Tt.colors[Tt.colors.length-1]).darker(1)}function j(t){d3.event.active||Rt.alphaTarget(0),"function"==typeof Tt.onNodeDragEnd&&Tt.onNodeDragEnd(t)}function E(t){G(t)}function R(t){d3.event.active||Rt.alphaTarget(.3).restart(),t.fx=t.x,t.fy=t.y,"function"==typeof Tt.onNodeDragStart&&Tt.onNodeDragStart(t)}function z(t){var e,n,r,o,i,a,s,u;if(Tt.images&&(n=Tt.imageMap[t.labels[0]]))for(o=0,e=0;e<n.length;e++){switch(a=n[e].split("|"),a.length){case 3:u=a[2];case 2:s=a[1];case 1:i=a[0]}t.labels[0]!==i||s&&void 0===t.properties[s]||u&&t.properties[s]!==u||a.length>o&&(r=Tt.images[n[e]],o=a.length)}return r}function S(t,e){A(Tt,e),Tt.icons&&(Tt.showIcons=!0),Tt.minCollision||(Tt.minCollision=2*Tt.nodeRadius),Et=t,bt=d3.select(Et),bt.attr("class","neo4jd3").html(""),Tt.infoPanel&&(wt=r(bt)),n(bt),Rt=F(),Tt.neo4jData?H(Tt.neo4jData):Tt.neo4jDataUrl?V(Tt.neo4jDataUrl):console.error("Error: both neo4jData and neo4jDataUrl are empty!"),jt=Ot.map(function(t){return Object.assign({},t)})}function F(){return d3.forceSimulation().force("collide",d3.forceCollide().radius(function(t){return Tt.minCollision})).force("charge",d3.forceManyBody().strength(-20).distanceMax(150).distanceMin(50)).force("link",d3.forceLink().id(function(t){return t.id}).distance(50)).force("center",d3.forceCenter(zt.node().parentElement.parentElement.clientWidth/2,zt.node().parentElement.parentElement.clientHeight/2)).on("tick",function(){Z()}).on("end",function(){Tt.zoomFit&&!qt&&(qt=!0,ut(2))})}function H(){Ct=[],Ot=[],nt(Tt.neo4jData)}function V(t){Ct=[],Ot=[],d3.json(t,function(t,e){if(t)throw t;nt(e)})}function A(t,e){Object.keys(e).forEach(function(n){t[n]=e[n]})}function q(t){var e={nodes:[],relationships:[]};return t.results.forEach(function(t){t.data.forEach(function(t){t.graph.nodes.forEach(function(t){L(e.nodes,t.id)||e.nodes.push(t)}),t.graph.relationships.forEach(function(t){L(e.relationships,t.id)||(t.source=t.startNode,t.target=t.endNode,e.relationships.push(t))}),t.graph.relationships.sort(function(t,e){return t.source>e.source?1:t.source<e.source?-1:t.target>e.target?1:t.target<e.target?-1:0});for(var n=0;n<t.graph.relationships.length;n++)0!==n&&t.graph.relationships[n].source===t.graph.relationships[n-1].source&&t.graph.relationships[n].target===t.graph.relationships[n-1].target?t.graph.relationships[n].linknum=t.graph.relationships[n-1].linknum+1:t.graph.relationships[n].linknum=1})}),e}function U(t,e,n){for(var r,o,i={nodes:[],relationships:[]},a=0;a<e.length;a++)r={id:e[a].id,labels:e[a].labels,properties:e[a].properties,x:t.x,y:t.y},i.nodes[i.nodes.length]=r;for(var s=0;s<n.length;s++)o={id:n[s].id,type:n[s].type,startNode:t.id.toString(),endNode:n[s].endNode,properties:n[s].properties,source:t.id,target:n[s].endNode},i.relationships[i.relationships.length]=o;et(i)}function T(t,e,n){for(var r,o,i={nodes:[],relationships:[]},a=0;a<e.length;a++)r={id:e[a].id,labels:e[a].labels,properties:e[a].properties,x:t.x,y:t.y},i.nodes[i.nodes.length]=r;for(var s=0;s<n.length;s++)o={id:n[s].id,type:n[s].type,startNode:n[s].startNode,endNode:t.id.toString(),properties:n[s].properties,source:n[s].startNode,target:t.id},i.relationships[i.relationships.length]=o;et(i)}function B(t,e,n,r,o){var i=Math.PI/180*o,a=Math.cos(i),s=Math.sin(i);return{x:a*(n-t)+s*(r-e)+t,y:a*(r-e)-s*(n-t)+e}}function I(t,e,n){return B(t.x,t.y,e.x,e.y,n)}function W(t,e){return 180*Math.atan2(e.y-t.y,e.x-t.x)/Math.PI}function P(){return{nodes:Ct.length,relationships:Ot.length}}function G(t){t.fx=d3.event.x,t.fy=d3.event.y}function Z(){J(),_()}function J(){kt&&kt.attr("transform",function(t){return"translate("+t.x+", "+t.y+")"})}function _(){Mt&&(Mt.attr("transform",function(t){Math.sqrt(Math.pow(t.source.x-t.target.x,2)+Math.pow(t.source.y-t.target.y,2))>400&&(t.source.fx=t.source.x,t.source.fy=t.source.y,t.target.fx=t.target.x,t.target.fy=t.target.y);var e=W(t.source,t.target);return"translate("+t.source.x+", "+t.source.y+") rotate("+e+")"}),K(),X(),Y())}function X(){Mt.each(function(){var t=d3.select(this),e=t.select(".outline"),n=t.select(".text");e.attr("d",function(t){var e={x:0,y:0},r=W(t.source,t.target),o=n.node().getBBox(),i=tt(t.source,t.target),a={x:.5*(t.target.x-t.source.x-(o.width+5)*i.x),y:.5*(t.target.y-t.source.y-(o.width+5)*i.y)},s=$(t.source,t.target),u=I(e,{x:0+(Tt.nodeRadius+1)*i.x-s.x,y:0+(Tt.nodeRadius+1)*i.y-s.y},r),l=I(e,{x:a.x-s.x,y:a.y-s.y},r),c=I(e,{x:a.x,y:a.y},r),d=I(e,{x:0+(Tt.nodeRadius+1)*i.x,y:0+(Tt.nodeRadius+1)*i.y},r),f=I(e,{x:t.target.x-t.source.x-a.x-s.x,y:t.target.y-t.source.y-a.y-s.y},r),p=I(e,{x:t.target.x-t.source.x-(Tt.nodeRadius+1)*i.x-s.x-i.x*Tt.arrowSize,y:t.target.y-t.source.y-(Tt.nodeRadius+1)*i.y-s.y-i.y*Tt.arrowSize},r),y=I(e,{x:t.target.x-t.source.x-(Tt.nodeRadius+1)*i.x-s.x+(s.x-i.x)*Tt.arrowSize,y:t.target.y-t.source.y-(Tt.nodeRadius+1)*i.y-s.y+(s.y-i.y)*Tt.arrowSize},r),x=I(e,{x:t.target.x-t.source.x-(Tt.nodeRadius+1)*i.x,y:t.target.y-t.source.y-(Tt.nodeRadius+1)*i.y},r),h=I(e,{x:t.target.x-t.source.x-(Tt.nodeRadius+1)*i.x+(-s.x-i.x)*Tt.arrowSize,y:t.target.y-t.source.y-(Tt.nodeRadius+1)*i.y+(-s.y-i.y)*Tt.arrowSize},r),g=I(e,{x:t.target.x-t.source.x-(Tt.nodeRadius+1)*i.x-i.x*Tt.arrowSize,y:t.target.y-t.source.y-(Tt.nodeRadius+1)*i.y-i.y*Tt.arrowSize},r),v=I(e,{x:t.target.x-t.source.x-a.x,y:t.target.y-t.source.y-a.y},r);return"M "+u.x+" "+u.y+" L "+l.x+" "+l.y+" L "+c.x+" "+c.y+" L "+d.x+" "+d.y+" Z M "+f.x+" "+f.y+" L "+p.x+" "+p.y+" L "+y.x+" "+y.y+" L "+x.x+" "+x.y+" L "+h.x+" "+h.y+" L "+g.x+" "+g.y+" L "+v.x+" "+v.y+" Z"})})}function Y(){Lt.attr("d",function(t){var e={x:0,y:0},n=W(t.source,t.target),r=$(t.source,t.target),o=$(t.source,t.target,50),i=I(e,{x:0-o.x,y:0-o.y},n),a=I(e,{x:t.target.x-t.source.x-o.x,y:t.target.y-t.source.y-o.y},n),s=I(e,{x:t.target.x-t.source.x+o.x-r.x,y:t.target.y-t.source.y+o.y-r.y},n),u=I(e,{x:0+o.x-r.x,y:0+o.y-r.y},n);return"M "+i.x+" "+i.y+" L "+a.x+" "+a.y+" L "+s.x+" "+s.y+" L "+u.x+" "+u.y+" Z"})}function K(){Dt.attr("transform",function(t){var e=(W(t.source,t.target)+360)%360,n=e>90&&e<270,r={x:0,y:0},o=$(t.source,t.target),i=n?2:-3,a={x:.5*(t.target.x-t.source.x)+o.x*i,y:.5*(t.target.y-t.source.y)+o.y*i},s=I(r,a,e);return"translate("+s.x+", "+s.y+") rotate("+(n?180:0)+")"})}function Q(t){var e=t.labels?t.labels[0]:t.type;return e+=" (<id>: "+t.id,Object.keys(t.properties).forEach(function(n){e+=", "+n+": "+JSON.stringify(t.properties[n])}),e+=")"}function $(t,e,n){return I({x:0,y:0},tt(t,e,n),90)}function tt(t,e,n){var r=Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))/Math.sqrt(n||1);return{x:(e.x-t.x)/r,y:(e.y-t.y)/r}}function et(t){it(t.nodes,t.relationships,!0)}function nt(t){et(q(t))}function rt(t){M(),t.labels?i("class",t.labels[0]):s("class",t.type),a("property","&lt;id&gt;",t.id),Object.keys(t.properties).forEach(function(e){a("property",e,JSON.stringify(t.properties[e]))})}function ot(t,e){e&&Array.prototype.push.apply(Ct,t),kt=St.selectAll(".node").data(Ct,function(t){return t.id});var n=c();kt=n.merge(kt)}function it(t,e,n){at(e,n),ot(t,n),Rt.nodes(Ct),Rt.force("link").links(Ot)}function at(t,e){e&&Array.prototype.push.apply(Ot,t),Mt=Ft.selectAll(".relationship").data(Ot,function(t){return t.id});var n=w();Mt=n.relationship.merge(Mt),Nt=zt.selectAll(".relationship .outline"),Nt=n.outline.merge(Nt),Lt=zt.selectAll(".relationship .overlay"),Lt=n.overlay.merge(Lt),Dt=zt.selectAll(".relationship .text"),Dt=n.text.merge(Dt)}function st(){return Bt}function ut(t){var e=zt.node().getBBox(),n=zt.node().parentElement.parentElement,r=n.clientWidth,o=n.clientHeight,i=e.width,a=e.height,s=e.x+i/2,u=e.y+a/2;0!==i&&0!==a&&(Ht=.85/Math.max(i/r,a/o),Vt=[r/2-Ht*s,o/2-Ht*u],zt.attr("transform","translate("+Vt[0]+", "+Vt[1]+") scale("+Ht+")"))}function lt(n){var r=Object.assign(e,{neo4jData:n,neo4jDataUrl:void 0});S(t,r)}function ct(t){Ot=Ot.filter(function(e){return e.source!==t&&e.target!==t||(d3.select("#"+e.uuid).remove(),!1)}),Ct=Ct.filter(function(e){return e!==t}),d3.select("#"+t.uuid).remove(),it(Ct,Ot,!1)}function dt(){function t(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return"g"+t()+t()+"-"+t()+"-"+t()+"-"+t()+"-"+t()+t()+t()}function ft(t){d3.selectAll(".views").remove();var e=d3.select("svg").selectAll("rect.views").data(t),n=20;return e.enter().append("rect").classed("views",!0).attr("x",n).attr("y",function(e){return 2.2*(t.indexOf(e)+1)*n+27}).attr("rx",n/3).attr("rx",n/3).attr("width",80).attr("height",n).attr("fill",function(e){return N()[t.indexOf(e)+1]}).attr("stroke",function(t){return"#000000"}).attr("stroke-width",function(t){return"0.5px"}).attr("cursor","pointer").on("click",function(t){"function"==typeof Tt.onViewsClickHandler&&Tt.onViewsClickHandler(t)}).on("mouseover",function(t){"function"==typeof Tt.onViewsMouseOverHandler&&Tt.onViewsMouseOverHandler(t)}).on("mouseleave",function(t){"function"==typeof Tt.onViewsMouseLeaveHandler&&Tt.onViewsMouseLeaveHandler(t)}),d3.select("svg").selectAll("text.views").data(t).enter().append("text").classed("views",!0).attr("text-anchor","left").attr("font-weight","bold").attr("stroke-width","0").attr("stroke-color","white").attr("fill","#696969").attr("x",40).attr("font-size","10px").attr("cursor","pointer").text(function(t){return t}).attr("y",function(e){return 2.2*(t.indexOf(e)+1)*n+40}).on("click",function(t){"function"==typeof Tt.onViewsClickHandler&&Tt.onViewsClickHandler(t)}).on("mouseover",function(t){"function"==typeof Tt.onViewsMouseOverHandler&&Tt.onViewsMouseOverHandler(t)}).on("mouseleave",function(t){"function"==typeof Tt.onViewsMouseLeaveHandler&&Tt.onViewsMouseLeaveHandler(t)}),e.exit().remove()}function pt(t){t.forEach(function(t){d3.select("#"+t.uuid).classed("node-highlighted",!0)})}function yt(t){t.forEach(function(t){d3.select("#"+t.uuid).classed("node-highlighted",!1)})}function xt(t){Ct.sort(function(e,n){return t[e.labels[0].toLowerCase()]-t[n.labels[0].toLowerCase()]});var e=0,n=700,r=200;Ct.forEach(function(o){t[o.labels[0].toLowerCase()]!==e&&(e=t[o.labels[0].toLowerCase()],r+=130,n=700),n+=150,o.fx=n,o.fy=r})}function ht(t){Ct.sort(function(e,n){return t[e.labels[0].toLowerCase()]-t[n.labels[0].toLowerCase()]});var e=0,n=700,r=200;Ct.forEach(function(o){t[o.labels[0].toLowerCase()]!==e&&(e=t[o.labels[0].toLowerCase()],r=200,n+=150),r+=150,o.fx=n,o.fy=r})}function gt(){return{nodes:Ct,relationships:Ot}}function vt(t){var e={nodes:[],relationships:[]},n=P();t.previous.forEach(function(r,o){var i=+Math.floor(200*Math.random()-75),a={id:r.node.id,labels:r.node.labels,properties:r.node.properties,x:t.x+i,y:t.y+i,fx:t.fx+i,fy:t.fy+i};e.nodes[e.nodes.length]=a,e.relationships[e.relationships.length]={id:r.link.id,type:r.link.type,properties:r.link.properties,startNode:a.id,endNode:t.id,source:a.id,target:t.id,linknum:n.relationships+1+o};var s=jt.filter(function(t){return t.source.id===a.id||t.target.id===a.id}),u=Ot.filter(function(e){return e.source===t||e.target===t});s.forEach(function(t){var e=u.find(function(e){return e.id===t.id});e&&(t.source.id===a.id?e.source=a:e.target=a)})}),t.collapsed=!1,t.previous=[],et(e)}function mt(t,e){if(e[t.labels[0].toLowerCase()]){var n=Ot.filter(function(e){return e.source===t||e.target===t}),r=n.find(function(n){return e.link.includes(n.type.toLowerCase())&&n.target.labels[0].toLowerCase()===e[t.labels[0].toLowerCase()]});r&&(r.target.collapsed=!0,n.splice(n.indexOf(r),1),r.target.previous||(r.target.previous=[]),r.target.previous.push({node:t,link:r}),n.forEach(function(e){e.collapsed=!0,e.source===t?(e.source=r.target,e.startNode=r.target.id):(e.target=r.target,e.endNode=r.target.id)}),ct(t))}}var bt,wt,kt,Ct,Mt,Nt,Lt,Dt,Ot,jt,Et,Rt,zt,St,Ft,Ht,Vt,At={},qt=!1,Ut=0,Tt={arrowSize:4,colors:N(),highlight:void 0,iconMap:{},icons:void 0,imageMap:{},images:void 0,infoPanel:!0,minCollision:void 0,neo4jData:void 0,neo4jDataUrl:void 0,nodeOutlineFillColor:void 0,nodeRadius:25,relationshipColor:"#a5abb6",zoomFit:!1},Bt="0.0.1";return S(t,e),{neo4jDataToD3Data:q,size:P,updateWithD3Data:et,updateWithNeo4jData:nt,appendDataToNodeOutward:U,appendDataToNodeInward:T,resetWithNeo4jData:lt,removeNode:ct,createViews:ft,highlightNodes:pt,unHighlightNodes:yt,orientForceGraphVertical:xt,orientForceGraphHorizontal:ht,getGraph:gt,collapseNode:mt,expandNode:vt,version:st}}e.exports=r},{}]},{},[1])(1)});